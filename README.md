# check_IMEI_bot (тестовое задание)

## Описание
Проект check_IMEI_bot - это бэкенд-система, интегрированная с Телеграм-ботом, которая позволяет пользователям проверять IMEI устройств.
Бот выпоняет запросы на API-сервис imeicheck.net и возвращает пользователю информацию о IMEI устройств.

В боте check_IMEI_bot реализовано:
- Регистрация пользователей (создание белого списка пользователей). При регистрации бот просит пользователя ввести API-токен (API Sandbox или API Live), проверяет валидность токена на сервисе imeicheck.net и при успешной проверке сохраняет пользователя (id Telegram, username, token) в базу данных PostgreSQL. После чего пользователь уже может пользоваться функционалом проверки IMEI устройств.
- Проверка валидности API-токенов. Бот сам находит и выбирает только бесплатные сервисы imeicheck.net (проверка условия, что цена = 0.00 и в описании сервиса есть строка "Mock service with only successful results"). Если бесплатный сервис не будет найден, то бот попросит пользователя ввести другой API-токен.
- Проверка вадидности введеного пользователем IMEI. 
- Хранение данных пользователей в БД Postgres. Функции работы с БД реализованы асинхронно для повышения производительности.
- использование библиотеки и сервера Redis для кэширования данных, повышения производительности и отказоустойчивости бота.
- В бэкенд-системе реализовано логирование.
- Для работы со списками пользователей (блокировка/разблокировка, удаление) реализовано администрирование с помощью
админ-панели Django (доступ через web-интерфес по адресу: http:+ ip вашего сервера + /admin/).

## Технолгии
- Python 3.11
- Aiogram 3.17
- Redis 5.2
- Django 5.1
- httpx 0.28
- PostgreSQL 16.6
- Loguru 0.7

## Запуск проекта
Клонировать репозиторий:
```
git clone https://github.com/KonstantinSKS/check_IMEI_bot.git
```
или по shh-ключу:
```
git@github.com:KonstantinSKS/check_IMEI_bot.git
```
Перейти в папку с проектом
```
cd check_IMEI_bot
```
Cоздать и активировать виртуальное окружение:
```
py -3.11 -m venv venv
```
```
source venv/Scripts/activate
```
Установить зависимости из файла requirements.txt:
```
python -m pip install --upgrade pip
```
```
pip install -r requirements.txt
```
В корне проекта создать файл .env
```
touch .env
```
и заполнить его по следующему образцу файла .env.template
(Обращаем Ваше внимание, что BOT_TOKEN вы должны получить заранее самостоятельно при создании и регистрации бот-чата в телеграм сервисе по созданию ботов https://t.me/BotFather).

Для запуска бота используйтся Docker, введите команду:
```
docker compose up -d --build
```

## Использование телеграм-бота:
- Для начала работы перейдите в чат check_IMEI_bot, нажмите кнопку "Menu" и затем всплывающую кнопку "/start".
- Если вы еще не зарегистрированы, то бот предложит вам ввести ваш API-токен. После успешной регистрации бот ответит вам сообщением "Вы успешно авторизованы." и предложит ввести IMEI.
- Введенный вами код IMEI бот отправит на сервис и вернет ответ JSON с информацией о устройстве.
 
## Администрирование в админ-панели Django:
Админ-панель Django доступна по адресу: http://127.0.0.1/admin/ или http:+ ip вашего сервера.
Учетная запись администратора создается автоматически. Логин и пароль для администратора задаются вами в .env-файле.
При наличии прав администратора в админ-панели доступны следующие возможности:
- Просмотр и управление пользователями чата. Управление включает в себя блокировку/разблокировку пользователя, а также удаление пользователя.


## Автор проекта:
Стеблев Константин
